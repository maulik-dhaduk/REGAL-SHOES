<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Checkout Page</title>
  <link rel="icon" type="image/x-icon" href="images/Favicon/154-2021_07_25-favicon_regal_250.jpg">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background: #fafafa;
      font-family: Arial, sans-serif;
    }

    .checkout-wrapper {
      padding: 60px 0;
    }

    .summary-card,
    .form-card {
      background: #fff;
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }


    .form-control {
      border: 1px solid #d2d2d2 !important;
      border-radius: 6px !important;
      padding: 10px 12px;
      font-size: 15px;
      box-shadow: none !important;
    }

    .form-control:focus {
      border-color: #000 !important;
      box-shadow: 0 0 0 1px #000 !important;
    }

    .summary-img {
      width: 70px;
      border-radius: 8px;
    }

    .total-amount {
      font-weight: 700;
      font-size: 18px;
    }

    .section-title {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 18px;
    }


    .pay-option input[type="radio"]:focus {
      outline: none !important;
      box-shadow: none !important;
    }

    .pay-option input[type="radio"]:checked {
      outline: none !important;
      box-shadow: none !important;
    }


    .pay-option.active {
      border: 2px solid #000 !important;
    }

    .pay-option {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px 12px;
      margin-bottom: 10px;
      cursor: pointer;
    }


    .place-order-btn {
      width: 100%;
      background: #000;
      color: #fff;
      border-radius: 30px;
      padding: 12px;
      font-size: 16px;
      font-weight: 600;
    }

    .cod-msg {
      font-size: 15px;
      background: #f8f8f8;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #eee;
    }

    .mb-small {
      margin-bottom: 6px;
    }

    .error {
      border-color: red !important;
    }

    .error-msg {
      color: red;
      font-size: 13px;
      margin-top: 3px;
    }



    .confirmation-box {
      max-width: 500px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
    }

    .confirmation-icon {
      font-size: 70px;
      color: #28a745;
    }

    .confirmation-title {
      font-weight: 700;
      opacity: 1;
      transform: translateY(0px);
      transition: opacity 0.5s, transform 0.5s;
    }

    .confirmation-message {
      font-size: 16px;
      color: #555;
    }

    .form-control:focus {
            border: 2px solid black !important;
            box-shadow: none !important;
        }
  </style>
</head>

<body>
  <div id="navbar-container"></div>
  <div class="flex-wrapper">
    <div class="container checkout-wrapper" id="checkout-page">

      <div class="row g-4">

        <div class="col-lg-4">
          <div class="summary-card">

            <h5 class="mb-3">Order Summary</h5>

            <div id="order-summary"></div>

            <div class="d-flex justify-content-between mb-small">
              <div>Subtotal</div>
              <div id="subtotal"></div>
            </div>

            <div style="height:10px;"></div>

            <div class="d-flex justify-content-between mb-small">
              <div>Shipping</div>
              <div id="shipping"></div>
            </div>

            <hr>

            <div class="d-flex justify-content-between total-amount">
              <div>Total</div>
              <div id="total"></div>
            </div>

          </div>
        </div>

        <div class="col-lg-8">
          <div class="form-card">

            <div class="section-title">Shipping Information</div>

            <div class="row g-3">
  <div class="col-md-6">
    <label class="form-label">First Name *</label>
    <input type="text" class="form-control" id="firstName" placeholder="Enter first name">
  </div>

  <div class="col-md-6">
    <label class="form-label">Last Name *</label>
    <input type="text" class="form-control" id="lastName" placeholder="Enter last name">
  </div>

  <div class="col-12">
    <label class="form-label">Email *</label>
    <input type="email" class="form-control" id="email" placeholder="Enter email address">
  </div>

  <div class="col-12">
    <label class="form-label">Phone Number *</label>
    <input type="text" class="form-control" id="phone" placeholder="Enter phone number">
  </div>

  <div class="col-12">
    <label class="form-label">Street Address *</label>
    <input type="text" class="form-control" id="address" placeholder="Enter street address">
  </div>

  <div class="col-md-4">
    <label class="form-label">City *</label>
    <input type="text" class="form-control" id="city" placeholder="City">
  </div>

  <div class="col-md-4">
    <label class="form-label">State *</label>
    <input type="text" class="form-control" id="state" placeholder="State">
  </div>

  <div class="col-md-4">
    <label class="form-label">ZIP Code *</label>
    <input type="text" class="form-control" id="zip" placeholder="ZIP Code">
  </div>
</div>


            <hr class="my-4">

            <div class="section-title">Payment Information</div>
            <div class="pay-option">
              <input type="radio" name="pay" value="card" checked> &nbsp; Card
            </div>

            <div class="pay-option">
              <input type="radio" name="pay" value="upi"> &nbsp; UPI
            </div>

            <div class="pay-option">
              <input type="radio" name="pay" value="cod"> &nbsp; Cash on Delivery
            </div>

            <div id="card-fields">
              <div class="row g-3 mt-2">
                <div class="col-12">
                  <label class="form-label">Card Number *</label>
                  <input type="text" class="form-control" placeholder="1234 5678 9012 3456" id="cardNumber">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Expiry Date *</label>
                  <input type="text" class="form-control" placeholder="MM/YY" id="expiry">
                </div>

                <div class="col-md-6">
                  <label class="form-label">CVV *</label>
                  <input type="text" class="form-control" placeholder="123" id="cvv">
                </div>

                <div class="col-12">
                  <label class="form-label">Name on Card *</label>
                  <input type="text" class="form-control" id="cardName">
                </div>
              </div>
            </div>

            <div id="upi-field" class="mt-3" style="display:none;">
              <label class="form-label">UPI ID *</label>
              <input type="text" class="form-control" placeholder="example@upi" id="upiId">
            </div>

            <div id="cod-msg" class="cod-msg mt-3" style="display:none;">
              You will pay with cash or card at the time of delivery.
            </div>

            <button class="place-order-btn mt-4">Place Order</button>

          </div>
        </div>

      </div>

    </div>

    <div id="footer-container"></div>
  </div>
  <script>
    let products = JSON.parse(localStorage.getItem("cart_product")) || [];
    let order_summary = document.getElementById("order-summary")

    products.map((pro) => {
      let sub_div = document.createElement("div")
      sub_div.classList.add("d-flex", "gap-3", "align-items-start");

      sub_div.innerHTML = `
            <img src="${pro.image}" class="summary-img">

      <div>
        <div class="fw-semibold mb-1">${pro.title}</div>
        <div class="text-muted small">Color: ${pro.color}</div>
        <div class="text-muted small mb-1">Quantity: ${pro.quantity}</div>
        <div class="fw-semibold">${pro.offer_rate}</div>
      </div>
          `
      let add_line = document.createElement("hr")

      order_summary.appendChild(sub_div);
      order_summary.appendChild(add_line);

    })


    function Update_Total() {
      let subtotal = 0

      products.map((pro) => {
        let product_price = parseFloat(pro.offer_rate.toString().replace(/[^0-9.]/g, ""));
        let product_total = product_price * pro.quantity
        subtotal = subtotal + product_total
      })

      let shipping_price = products.length > 0 ? 50 : 0
      let main_total = subtotal + shipping_price

      document.getElementById("subtotal").innerText = subtotal.toFixed(2);
      document.getElementById("shipping").innerText = shipping_price;
      document.getElementById("total").innerText = main_total.toFixed(2);
    }

    Update_Total()

    const cardFields = document.getElementById("card-fields");
    const upiField = document.getElementById("upi-field");
    const codMsg = document.getElementById("cod-msg");

    document.querySelectorAll(".pay-option").forEach(option => {
      option.addEventListener("click", function () {


        document.querySelectorAll(".pay-option").forEach(o => o.classList.remove("active"));


        this.classList.add("active");


        this.querySelector("input[type='radio']").checked = true;

        let method = this.querySelector("input[type='radio']").value;


        cardFields.style.display = (method === "card") ? "block" : "none";
        upiField.style.display = (method === "upi") ? "block" : "none";
        codMsg.style.display = (method === "cod") ? "block" : "none";
      });
    });



    function showError(input, message) {
      input.style.borderColor = "red";

      let msg = input.nextElementSibling;
      if (!msg || !msg.classList.contains("error-msg")) {
        let div = document.createElement("div");
        div.className = "error-msg";
        div.style.color = "red";
        div.style.fontSize = "13px";
        div.innerText = message;
        input.insertAdjacentElement("afterend", div);
      }
    }

    function clearError(input) {
      input.style.borderColor = "#d2d2d2";
      let msg = input.nextElementSibling;
      if (msg && msg.classList.contains("error-msg")) msg.remove();
    }


    function validateShipping() {
      let valid = true;

      let fields = [
        "firstName", "lastName", "email", "phone",
        "address", "city", "state", "zip"
      ];

      fields.forEach(id => {
        let input = document.getElementById(id);
        clearError(input);

        if (input.value.trim() === "") {
          showError(input, "Required");
          valid = false;
        }
      });


      let email = document.getElementById("email");
      if (email.value && !email.value.includes("@")) {
        showError(email, "Invalid email");
        valid = false;
      }


      let phone = document.getElementById("phone");
      if (phone.value.length !== 10) {
        showError(phone, "Phone must be 10 digits");
        valid = false;
      }

      let zip = document.getElementById("zip");
      if (zip.value.length < 5 || zip.value.length > 6) {
        showError(zip, "ZIP must be 5-6 digits");
        valid = false;
      }

      return valid;
    }



    function validatePayment() {
      let pay = document.querySelector("input[name='pay']:checked").value;
      let valid = true;

      if (pay === "card") {
        let card = document.getElementById("cardNumber");
        let exp = document.getElementById("expiry");
        let cvv = document.getElementById("cvv");
        let name = document.getElementById("cardName");

        clearError(card); clearError(exp); clearError(cvv); clearError(name);

        if (card.value.length !== 16) {
          showError(card, "16-digit card number required");
          valid = false;
        }

        if (!exp.value.includes("/")) {
          showError(exp, "MM/YY required");
          valid = false;
        }

        if (cvv.value.length !== 3) {
          showError(cvv, "3-digit CVV required");
          valid = false;
        }

        if (name.value.trim() === "") {
          showError(name, "Cardholder name required");
          valid = false;
        }
      }

      if (pay === "upi") {
        let upi = document.getElementById("upiId");
        clearError(upi);

        if (!upi.value.includes("@")) {
          showError(upi, "Invalid UPI ID");
          valid = false;
        }
      }

      return valid;
    }


    function showSuccessMessage() {
      const successHTML = `
    <div class="container py-5 d-flex justify-content-center">
      <div class="text-center p-4 confirmation-box">

        <i class="fas fa-check-circle confirmation-icon mb-3"></i>

        <h1 class="confirmation-title">Thank You for Your Order!</h1>

        <p class="confirmation-message mt-2">
          Your order has been successfully placed and will be processed shortly.
        </p>

        <div class="mt-4">
          <a href="index.html" class="btn btn-dark px-4 py-2 rounded-pill">
            Continue Shopping
          </a>
        </div>

      </div>
    </div>
  `;

      document.getElementById("checkout-page").innerHTML = successHTML;
    }



    document.querySelector(".place-order-btn").addEventListener("click", function (e) {
      e.preventDefault();

      let shippingOK = validateShipping();
      let paymentOK = validatePayment();

      if (shippingOK && paymentOK) {
        showSuccessMessage();
        localStorage.removeItem("cart_product")
        localStorage.removeItem("wishlist_product")
        updateLikeCounter()
        updateCartCounter()
      }

    });



    function onlyNumbers(e) {
      e.target.value = e.target.value.replace(/\D/g, "");
    }

    document.getElementById("phone").addEventListener("input", onlyNumbers);
    document.getElementById("zip").addEventListener("input", onlyNumbers);
    document.getElementById("cardNumber").addEventListener("input", onlyNumbers);
    document.getElementById("cvv").addEventListener("input", onlyNumbers);

  </script>

  <script src="js/global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>



</body>

</html>